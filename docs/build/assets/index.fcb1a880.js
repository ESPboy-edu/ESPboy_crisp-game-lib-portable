(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();let a,d;function T(e,t){a!=null&&(document.body.removeChild(a),window.removeEventListener("resize",b));const n="#e0e0e0",i=`
-webkit-touch-callout: none;
-webkit-tap-highlight-color: ${n};
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
background: ${n};
color: #888;
`,o=`
position: absolute;
left: 50%;
top: 50%;
transform: translate(-50%, -50%);
`,r=`
image-rendering: -moz-crisp-edges;
image-rendering: -webkit-optimize-contrast;
image-rendering: -o-crisp-edges;
image-rendering: pixelated;
`;document.body.style.cssText=i,a=document.createElement("canvas"),a.width=e,a.height=t,d=a.getContext("2d"),d.imageSmoothingEnabled=!1,a.style.cssText=o+r,document.body.appendChild(a),window.addEventListener("resize",b),b()}function b(){const t=innerWidth/innerHeight,n=a.width/a.height,i=t<n,o=i?.95*innerWidth:.95*innerHeight*n,r=i?.95*innerWidth/n:.95*innerHeight;a.style.width=`${o}px`,a.style.height=`${r}px`}function $(e,t,n){d.fillStyle=h(e,t,n),d.fillRect(0,0,a.width,a.height)}window.clearView=(e,t,n)=>{$(e,t,n)};window.clearScreen=(e,t,n)=>{document.body.style.background=h(e,t,n)};function F(e){return e.toString(16).padStart(2,"0")}function h(e,t,n){return`#${F(e)}${F(t)}${F(n)}`}function U(e,t,n,i,o,r,c){d.fillStyle=h(o,r,c),d.fillRect(Math.floor(e),Math.floor(t),Math.trunc(n),Math.trunc(i))}window.drawRect=(e,t,n,i,o,r,c)=>{U(e,t,n,i,o,r,c)};const m=6;let K,f,p;function H(e){p.clearRect(0,0,m,m);let t=e;for(let i=0;i<m;i++)for(let o=0;o<m;o++,t+=3){const r=Module.HEAPU8[t],c=Module.HEAPU8[t+1],M=Module.HEAPU8[t+2];(r>0||c>0||M>0)&&(p.fillStyle=h(r,c,M),p.fillRect(o,i,1,1))}const n=document.createElement("img");return n.src=f.toDataURL(),n}window.drawCharacter=(e,t,n,i)=>{let o=K[i];o==null&&(o=H(e),K[i]=o),d.drawImage(o,Math.floor(t),Math.floor(n))};function z(){f=document.createElement("canvas"),f.width=f.height=m,p=f.getContext("2d"),K={}}let A,E,k,C,D,w,y;function I(){q(),y=!1,document.addEventListener("mousedown",e=>{S()}),document.addEventListener("touchstart",e=>{S()}),document.addEventListener("mouseup",e=>{N()}),document.addEventListener("touchend",e=>{e.preventDefault(),e.target.click(),N()},{passive:!1})}function O(){V(y)}function S(){y=!0}function N(){y=!1}let s;function q(){A=E=k=C=D=w=!1,s={},document.addEventListener("keydown",e=>{s[e.code]=!0,(e.code==="AltLeft"||e.code==="AltRight"||e.code==="ArrowRight"||e.code==="ArrowDown"||e.code==="ArrowLeft"||e.code==="ArrowUp")&&e.preventDefault()}),document.addEventListener("keyup",e=>{s[e.code]=!1})}function V(e){if(A=s.ArrowLeft,E=s.ArrowRight,k=s.ArrowUp,C=s.ArrowDown,D=s.KeyZ||s.KeyB,w=e,!w){for(let t=0;t<P.length;t++)if(s[P[t]]){w=!0;break}}}const P=["KeyX","KeyA","Escape","Digit0","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter","ControlLeft","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backquote","ShiftLeft","Backslash","KeyC","KeyV","KeyN","KeyM","Comma","ShiftRight","NumpadMultiply","AltLeft","Space","CapsLock","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","Pause","ScrollLock","Numpad7","Numpad8","Numpad9","NumpadSubtract","Numpad4","Numpad5","Numpad6","NumpadAdd","Numpad1","Numpad2","Numpad3","Numpad0","NumpadDecimal","IntlBackslash","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24","IntlYen","Undo","Paste","MediaTrackPrevious","Cut","Copy","MediaTrackNext","NumpadEnter","ControlRight","LaunchMail","AudioVolumeMute","MediaPlayPause","MediaStop","Eject","AudioVolumeDown","AudioVolumeUp","BrowserHome","NumpadDivide","PrintScreen","AltRight","Help","NumLock","Pause","Home","PageUp","End","PageDown","Insert","Delete","OSLeft","OSRight","ContextMenu","BrowserSearch","BrowserFavorites","BrowserRefresh","BrowserStop","BrowserForward","BrowserBack"];let l,g;function W(){l=new(window.AudioContext||window.webkitAudioContext),window.addEventListener("mousedown",L),window.addEventListener("touchstart",L),window.addEventListener("keydown",L),g=l.createGain(),g.gain.value=.05,g.connect(l.destination)}window.playTone=(e,t,n)=>{const i=l.createOscillator();i.type="square",i.frequency.value=e,i.start(n),i.stop(n+t),i.connect(g)};window.stopTone=()=>{};window.getAudioTime=()=>l.currentTime;function L(){l.resume()}function G(){O(),Module.ccall("setButtonState","void",["boolean","boolean","boolean","boolean","boolean","boolean"],[A,E,k,C,D,w]),Module.ccall("updateFrame","void",[],[])}const R=68,v=1e3/R;let u=0;function B(){requestAnimationFrame(B);const e=window.performance.now();e<u-R/12||(u+=v,(u<e||u>e+v*2)&&(u=e+v),G())}function j(){I(),W(),Module.ccall("initGame","void",[],[]),B()}window.initView=(e,t)=>{T(e,t),z()};window.Module={onRuntimeInitialized:j};const x=document.createElement("script");x.setAttribute("src","./wasm/cglp.js");document.head.appendChild(x);
